<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WISeR Packet Intake Dashboard - Prior Authorization Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Screen reader only class */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }
      
      /* Skip link visible on focus */
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #3b82f6;
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        font-weight: 600;
        z-index: 9999;
        border-radius: 0 0 4px 0;
      }
      
      .skip-link:focus {
        top: 0;
      }
      
      /* Ensure focus visible on all interactive elements */
      button:focus-visible,
      a:focus-visible,
      input:focus-visible,
      select:focus-visible,
      [role="button"]:focus-visible {
        outline: 3px solid #3b82f6;
        outline-offset: 2px;
      }
      
      /* Respect reduced motion preferences */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
      
      /* Improve color contrast for small text */
      .text-gray-500 {
        color: #4b5563; /* Darker gray-600 for better contrast */
      }
      
      .text-gray-400 {
        color: #6b7280; /* Darker gray-500 for better contrast */
      }
    </style>
</head>
<body class="bg-gray-50">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div id="root"></div>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const PacketsDashboard = () => {
          const [searchTerm, setSearchTerm] = React.useState('');
          const [filterHighLevelStatus, setFilterHighLevelStatus] = React.useState('all');
          const [filterDetailedStatus, setFilterDetailedStatus] = React.useState('all');
          const [filterPriority, setFilterPriority] = React.useState('all');
          const [filterChannel, setFilterChannel] = React.useState('all');
          const [quickFiltersExpanded, setQuickFiltersExpanded] = React.useState(false); // Collapsed by default

          // Helper function to determine packet detail view status
          const getDetailViewStatus = (packet) => {
            const status = packet.status || packet.highLevelStatus;
            
            // Complete states
            if (status.includes('Closed') || status.includes('Delivered') || status.includes('Dismissed')) {
              return 'complete';
            }
            
            // In-progress states (clinical review or delivery)
            if (status.includes('Clinical Review') || status.includes('Delivery')) {
              return 'in-progress';
            }
            
            // All other states are intake/validation
            return 'intake';
          };

          const packets = [
            {
              id: 'PKT-2025-001234',
              receivedDate: '2025-12-04 14:30',
              channel: 'Fax',
              highLevelStatus: 'Intake Processing',
              status: 'Manual Review',
              statusColor: 'amber',
              patient: 'John Smith',
              mbi: '1EG4TE5MK72',
              provider: 'ABC Medical Clinic',
              npi: '1234567890',
              service: 'L0450',
              priority: 'Standard',
              stage: 'Field Correction',
              assignedTo: 'Jane Reviewer',
              reviewType: 'fields'
            },
            {
              id: 'PKT-2025-001235',
              receivedDate: '2025-12-04 15:00',
              channel: 'esMD',
              highLevelStatus: 'Intake Processing',
              status: 'Validating',
              statusColor: 'blue',
              patient: 'Mary Johnson',
              mbi: '1AB2CD3EF45',
              provider: 'XYZ Health',
              npi: '9876543210',
              service: 'L0454',
              priority: 'Standard',
              stage: 'Eligibility Check',
              assignedTo: 'Auto'
            },
            {
              id: 'PKT-2025-001236',
              receivedDate: '2025-12-04 13:15',
              channel: 'Portal',
              highLevelStatus: 'Clinical Review',
              status: 'Case Created',
              statusColor: 'green',
              patient: 'Robert Williams',
              mbi: '1GH4IJ5KL67',
              provider: 'City Orthopedics',
              npi: '5551234567',
              service: 'L0631',
              priority: 'Expedited',
              stage: 'Clinical Intake',
              clinicalStatus: 'Pending Review',
              assignedTo: 'Auto'
            },
            {
              id: 'PKT-2025-001237',
              receivedDate: '2025-12-04 12:00',
              channel: 'Fax',
              highLevelStatus: 'Closed - Dismissed',
              status: 'Dismissed',
              statusColor: 'red',
              patient: 'Sarah Davis',
              mbi: '1MN4OP5QR89',
              provider: 'County Medical',
              npi: '8887776655',
              service: 'L0450',
              priority: 'Standard',
              stage: 'Complete',
              assignedTo: 'Auto',
              dismissalReason: 'Ineligible beneficiary (MA enrolled)'
            },
            {
              id: 'PKT-2025-001238',
              receivedDate: '2025-12-04 11:30',
              channel: 'Mailroom',
              highLevelStatus: 'Intake Processing',
              status: 'Manual Review',
              statusColor: 'amber',
              patient: 'James Brown',
              mbi: '1ST4UV5WX01',
              provider: 'Valley Spine Center',
              npi: '4443332221',
              service: 'L0972',
              priority: 'Standard',
              stage: 'Document Classification',
              assignedTo: 'John Reviewer',
              reviewType: 'classification'
            },
            {
              id: 'PKT-2025-001239',
              receivedDate: '2025-12-03 09:45',
              channel: 'esMD',
              highLevelStatus: 'Delivery In Progress',
              status: 'Case Created',
              statusColor: 'green',
              patient: 'Hemanth Pande',
              mbi: '1YZ2AB3CD45',
              provider: 'Metro Health',
              npi: '7778889990',
              service: 'L1832',
              priority: 'High',
              stage: 'Letter Delivery',
              clinicalStatus: 'Completed',
              deliveryStatus: 'Fax In Progress',
              assignedTo: 'Auto'
            },
            {
              id: 'PKT-2025-001240',
              receivedDate: '2025-12-02 14:20',
              channel: 'Portal',
              highLevelStatus: 'Closed - Delivered',
              status: 'Case Created',
              statusColor: 'green',
              patient: 'Piyush Saxena',
              mbi: '1EF2GH3IJ56',
              provider: 'Sunny Orthopaedic',
              npi: '3334445556',
              service: 'L0450',
              priority: 'Medium',
              stage: 'Complete',
              clinicalStatus: 'Completed',
              deliveryStatus: 'Sent',
              closedDate: '2025-12-02 16:45',
              assignedTo: 'Auto'
            }
          ];

          const filteredPackets = packets.filter(p => {
            const matchesSearch = 
              p.id.toLowerCase().includes(searchTerm.toLowerCase()) ||
              p.patient.toLowerCase().includes(searchTerm.toLowerCase()) ||
              p.mbi.toLowerCase().includes(searchTerm.toLowerCase()) ||
              p.npi.toLowerCase().includes(searchTerm.toLowerCase());
            
            const matchesHighLevelStatus = filterHighLevelStatus === 'all' || p.highLevelStatus === filterHighLevelStatus;
            const matchesDetailedStatus = filterDetailedStatus === 'all' || p.status === filterDetailedStatus;
            const matchesPriority = filterPriority === 'all' || p.priority === filterPriority;
            const matchesChannel = filterChannel === 'all' || p.channel === filterChannel;
            
            return matchesSearch && matchesHighLevelStatus && matchesDetailedStatus && matchesPriority && matchesChannel;
          });

          const statusCounts = {
            total: packets.length,
            intakeProcessing: packets.filter(p => p.highLevelStatus === 'Intake Processing').length,
            clinicalReview: packets.filter(p => p.highLevelStatus === 'Clinical Review').length,
            deliveryInProgress: packets.filter(p => p.highLevelStatus === 'Delivery In Progress').length,
            closedDelivered: packets.filter(p => p.highLevelStatus === 'Closed - Delivered').length,
            closedDismissed: packets.filter(p => p.highLevelStatus === 'Closed - Dismissed').length,
            manualReview: packets.filter(p => p.status === 'Manual Review').length
          };

          // Calculate SLA breaches
          const calculateSLABreaches = () => {
            const now = new Date('2025-12-04 16:00'); // Simulated current time
            
            const getHoursElapsed = (receivedDate) => {
              const received = new Date(receivedDate);
              return (now - received) / (1000 * 60 * 60);
            };

            return {
              intake: packets.filter(p => 
                p.highLevelStatus === 'Intake Processing' && 
                getHoursElapsed(p.receivedDate) > 48
              ).length,
              clinical: packets.filter(p => 
                p.highLevelStatus === 'Clinical Review' && 
                getHoursElapsed(p.receivedDate) > 72
              ).length,
              delivery: packets.filter(p => 
                p.highLevelStatus === 'Delivery In Progress' && 
                getHoursElapsed(p.receivedDate) > 12
              ).length,
              total: 0
            };
          };

          const slaBreaches = calculateSLABreaches();
          slaBreaches.total = slaBreaches.intake + slaBreaches.clinical + slaBreaches.delivery;

          // Handle status block click
          const handleStatusBlockClick = (status) => {
            setFilterHighLevelStatus(status);
            setFilterDetailedStatus('all');
            setFilterPriority('all');
            setFilterChannel('all');
            setSearchTerm('');
          };

          const getStatusBadge = (status, color) => {
            const colors = {
              amber: 'bg-amber-100 text-amber-800 border-amber-300',
              blue: 'bg-blue-100 text-blue-800 border-blue-300',
              green: 'bg-green-100 text-green-800 border-green-300',
              red: 'bg-red-100 text-red-800 border-red-300',
              gray: 'bg-gray-100 text-gray-800 border-gray-300'
            };
            return colors[color] || colors.gray;
          };

          return (
            <div className="min-h-screen bg-gray-50 p-6">
              {/* Header */}
              <header className="mb-6">
                <div className="flex items-center justify-between mb-4">
                  <div>
                    <h1 id="main-content" className="text-3xl font-bold text-gray-900">WISeR Packet Intake Dashboard</h1>
                    <p className="text-gray-700 mt-1">Monitor and manage all incoming prior authorization packets</p>
                  </div>
                  <nav aria-label="Dashboard navigation">
                    <div className="flex gap-3">
                      <a 
                        href="FINAL_clinical_review_dashboard.html"
                        className="bg-purple-600 text-white px-6 py-3 rounded hover:bg-purple-700 font-semibold flex items-center gap-2"
                        aria-label="Navigate to Clinical Review Dashboard"
                      >
                        <span aria-hidden="true">üë®‚Äç‚öïÔ∏è</span> Clinical Review
                      </a>
                      <a 
                        href="FINAL_analytics_dashboard.html"
                        className="bg-amber-600 text-white px-6 py-3 rounded hover:bg-amber-700 font-semibold flex items-center gap-2"
                        aria-label="Navigate to Aging and Operations Dashboard"
                      >
                        <span aria-hidden="true">üìä</span> Aging & Ops
                      </a>
                      <a 
                        href="FINAL_analytics_insights_dashboard.html"
                        className="bg-indigo-600 text-white px-6 py-3 rounded hover:bg-indigo-700 font-semibold flex items-center gap-2"
                        aria-label="Navigate to Analytics and Insights Dashboard"
                      >
                        <span aria-hidden="true">üìà</span> Analytics
                      </a>
                      <a 
                        href="FINAL_outbound_communication_dashboard.html"
                        className="bg-orange-600 text-white px-6 py-3 rounded hover:bg-orange-700 font-semibold flex items-center gap-2"
                        aria-label="Navigate to Outbound Communication Dashboard"
                      >
                        <span aria-hidden="true">üìÆ</span> Outbound Communication
                      </a>
                    </div>
                  </nav>
                </div>
              </header>

              {/* Main Content */}
              <main>
                {/* Status Summary Section */}
                <section aria-labelledby="status-summary-heading">
                  <h2 id="status-summary-heading" className="sr-only">Status Summary</h2>

              {/* Stats Cards - High Level Status Tracking (Clean Design with Aging Alerts) */}
              <div className="grid grid-cols-6 gap-4 mb-6">
                <div className="bg-white rounded-lg shadow p-4 border-l-4 border-gray-400">
                  <div className="text-2xl font-bold text-gray-900">{statusCounts.total}</div>
                  <div className="text-sm text-gray-600">Total Packets</div>
                  <div className="text-xs text-gray-500 mt-1">Last 24 hours</div>
                </div>
                
                <div 
                  onClick={() => handleStatusBlockClick('Intake Processing')}
                  className={`bg-white rounded-lg shadow p-4 border-l-4 border-amber-500 cursor-pointer 
                    hover:shadow-lg transition-all duration-200
                    ${filterHighLevelStatus === 'Intake Processing' ? 'ring-2 ring-amber-400' : ''}`}
                  role="button"
                  tabIndex={0}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      handleStatusBlockClick('Intake Processing');
                    }
                  }}
                  aria-label={`Filter to Intake Processing packets. ${statusCounts.intakeProcessing} total packets${slaBreaches.intake > 0 ? `, ${slaBreaches.intake} packets over SLA` : ''}`}
                  aria-pressed={filterHighLevelStatus === 'Intake Processing'}
                >
                  <div className="flex items-start justify-between mb-2">
                    <div className="text-2xl font-bold text-gray-900">{statusCounts.intakeProcessing}</div>
                    {slaBreaches.intake > 0 && (
                      <div className="text-right">
                        <div className="text-xs text-amber-600 font-semibold">Aging Alert</div>
                        <div className="text-lg font-bold text-amber-700">{slaBreaches.intake}</div>
                      </div>
                    )}
                  </div>
                  <div className="text-sm text-gray-700 font-medium">Intake Processing</div>
                  <div className="text-xs text-gray-500 mt-1">
                    {slaBreaches.intake > 0 ? `${slaBreaches.intake} over SLA` : 'Currently in intake'}
                  </div>
                </div>

                <div 
                  onClick={() => handleStatusBlockClick('Clinical Review')}
                  className={`bg-white rounded-lg shadow p-4 border-l-4 border-purple-500 cursor-pointer 
                    hover:shadow-lg transition-all duration-200
                    ${filterHighLevelStatus === 'Clinical Review' ? 'ring-2 ring-purple-400' : ''}`}
                  role="button"
                  tabIndex={0}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      handleStatusBlockClick('Clinical Review');
                    }
                  }}
                  title="Click to filter to Clinical Review packets"
                >
                  <div className="flex items-start justify-between mb-2">
                    <div className="text-2xl font-bold text-gray-900">{statusCounts.clinicalReview}</div>
                    {slaBreaches.clinical > 0 && (
                      <div className="text-right">
                        <div className="text-xs text-purple-600 font-semibold">Aging Alert</div>
                        <div className="text-lg font-bold text-purple-700">{slaBreaches.clinical}</div>
                      </div>
                    )}
                  </div>
                  <div className="text-sm text-gray-700 font-medium">Clinical Review</div>
                  <div className="text-xs text-gray-500 mt-1">
                    {slaBreaches.clinical > 0 ? `${slaBreaches.clinical} over SLA` : 'With clinical team'}
                  </div>
                </div>

                <div 
                  onClick={() => handleStatusBlockClick('Delivery In Progress')}
                  className={`bg-white rounded-lg shadow p-4 border-l-4 border-orange-500 cursor-pointer 
                    hover:shadow-lg transition-all duration-200
                    ${filterHighLevelStatus === 'Delivery In Progress' ? 'ring-2 ring-orange-400' : ''}`}
                  role="button"
                  tabIndex={0}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      handleStatusBlockClick('Delivery In Progress');
                    }
                  }}
                  title="Click to filter to Delivery In Progress packets"
                >
                  <div className="flex items-start justify-between mb-2">
                    <div className="text-2xl font-bold text-gray-900">{statusCounts.deliveryInProgress}</div>
                    {slaBreaches.delivery > 0 && (
                      <div className="text-right">
                        <div className="text-xs text-orange-600 font-semibold">Aging Alert</div>
                        <div className="text-lg font-bold text-orange-700">{slaBreaches.delivery}</div>
                      </div>
                    )}
                  </div>
                  <div className="text-sm text-gray-700 font-medium">Delivery In Progress</div>
                  <div className="text-xs text-gray-500 mt-1">
                    {slaBreaches.delivery > 0 ? `${slaBreaches.delivery} over SLA` : 'Letter being sent'}
                  </div>
                </div>

                <div 
                  onClick={() => handleStatusBlockClick('Closed - Delivered')}
                  className={`bg-white rounded-lg shadow p-4 border-l-4 border-green-500 cursor-pointer 
                    hover:shadow-lg transition-all duration-200
                    ${filterHighLevelStatus === 'Closed - Delivered' ? 'ring-2 ring-green-400' : ''}`}
                  role="button"
                  tabIndex={0}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      handleStatusBlockClick('Closed - Delivered');
                    }
                  }}
                  title="Click to filter to Delivered packets"
                >
                  <div className="text-2xl font-bold text-gray-900 mb-2">{statusCounts.closedDelivered}</div>
                  <div className="text-sm text-gray-700 font-medium">Closed - Delivered</div>
                  <div className="text-xs text-gray-500 mt-1">Successfully completed</div>
                </div>

                <div 
                  onClick={() => handleStatusBlockClick('Closed - Dismissed')}
                  className={`bg-white rounded-lg shadow p-4 border-l-4 border-red-500 cursor-pointer 
                    hover:shadow-lg transition-all duration-200
                    ${filterHighLevelStatus === 'Closed - Dismissed' ? 'ring-2 ring-red-400' : ''}`}
                  role="button"
                  tabIndex={0}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                      e.preventDefault();
                      handleStatusBlockClick('Closed - Dismissed');
                    }
                  }}
                  title="Click to filter to Dismissed packets"
                >
                  <div className="text-2xl font-bold text-gray-900 mb-2">{statusCounts.closedDismissed}</div>
                  <div className="text-sm text-gray-700 font-medium">Closed - Dismissed</div>
                  <div className="text-xs text-gray-500 mt-1">Did not proceed</div>
                </div>
              </div>
              </section>

              {/* Active Filters Display */}
              {(filterHighLevelStatus !== 'all' || filterDetailedStatus !== 'all' || filterPriority !== 'all' || filterChannel !== 'all' || searchTerm) && (
                <div className="bg-white rounded-lg shadow-sm p-3 mb-4 border border-gray-200">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-2 flex-wrap">
                      <span className="text-sm font-medium text-gray-600">Active Filters:</span>
                      {filterHighLevelStatus !== 'all' && (
                        <span className="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm border border-blue-300">
                          {filterHighLevelStatus}
                          <button onClick={() => setFilterHighLevelStatus('all')} className="hover:bg-blue-200 rounded px-1" aria-label="Remove status filter"><span aria-hidden="true">‚úï</span></button>
                        </span>
                      )}
                      {filterDetailedStatus !== 'all' && (
                        <span className="inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 rounded text-sm border border-purple-300">
                          {filterDetailedStatus}
                          <button onClick={() => setFilterDetailedStatus('all')} className="hover:bg-purple-200 rounded px-1" aria-label="Remove detailed status filter"><span aria-hidden="true">‚úï</span></button>
                        </span>
                      )}
                      {filterPriority !== 'all' && (
                        <span className="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded text-sm border border-orange-300">
                          Priority: {filterPriority}
                          <button onClick={() => setFilterPriority('all')} className="hover:bg-orange-200 rounded px-1" aria-label="Remove priority filter"><span aria-hidden="true">‚úï</span></button>
                        </span>
                      )}
                      {filterChannel !== 'all' && (
                        <span className="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded text-sm border border-green-300">
                          {filterChannel}
                          <button onClick={() => setFilterChannel('all')} className="hover:bg-green-200 rounded px-1" aria-label="Remove channel filter"><span aria-hidden="true">‚úï</span></button>
                        </span>
                      )}
                      {searchTerm && (
                        <span className="inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded text-sm border border-gray-300">
                          Search: "{searchTerm}"
                          <button onClick={() => setSearchTerm('')} className="hover:bg-gray-200 rounded px-1" aria-label="Clear search"><span aria-hidden="true">‚úï</span></button>
                        </span>
                      )}
                    </div>
                    <span 
                      className="text-sm text-gray-700 font-medium"
                      role="status"
                      aria-live="polite"
                      aria-atomic="true"
                    >
                      Showing {filteredPackets.length} of {packets.length} packets
                    </span>
                  </div>
                </div>
              )}

              {/* Filters - Combined Quick and Advanced */}
              <div className="bg-white rounded-lg shadow mb-6 border border-gray-200">
                <div 
                  className="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50"
                  onClick={() => setQuickFiltersExpanded(!quickFiltersExpanded)}
                >
                  <div className="flex items-center gap-2">
                    <span className="text-lg">{quickFiltersExpanded ? '‚ñº' : '‚ñ∂'}</span>
                    <span className="text-sm font-semibold text-gray-700">Filters</span>
                    {!quickFiltersExpanded && (searchTerm || filterHighLevelStatus !== 'all' || filterDetailedStatus !== 'all' || filterPriority !== 'all' || filterChannel !== 'all') && (
                      <span className="text-xs text-gray-500 ml-2">
                        ({[searchTerm, filterHighLevelStatus !== 'all', filterDetailedStatus !== 'all', filterPriority !== 'all', filterChannel !== 'all'].filter(Boolean).length} active)
                      </span>
                    )}
                  </div>
                  <button className="text-sm text-gray-500 hover:text-gray-700">
                    {quickFiltersExpanded ? 'Collapse' : 'Expand'}
                  </button>
                </div>

                {quickFiltersExpanded && (
                  <div className="px-4 pb-4 border-t border-gray-100">
                    {/* Quick Filter Buttons Row */}
                    <div className="flex items-center justify-between pt-4 pb-4 border-b border-gray-100">
                      <div className="flex items-center gap-3">
                        <span className="text-xs font-medium text-gray-500 uppercase">Quick Filters:</span>
                        <button
                          onClick={() => {
                            // Clear all filters first
                            setSearchTerm('');
                            setFilterHighLevelStatus('all');
                            setFilterDetailedStatus('all');
                            setFilterChannel('all');
                            // Then set this specific filter
                            setFilterPriority('Expedited');
                          }}
                          className="px-3 py-1.5 bg-orange-100 hover:bg-orange-200 text-orange-800 rounded-md text-sm font-medium transition-colors border border-orange-300"
                        >
                          ‚ö° Expedited Cases
                        </button>
                        <button
                          onClick={() => {
                            // Clear all filters first
                            setSearchTerm('');
                            setFilterHighLevelStatus('all');
                            setFilterPriority('all');
                            setFilterChannel('all');
                            // Then set this specific filter
                            setFilterDetailedStatus('Manual Review');
                          }}
                          className="px-3 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-800 rounded-md text-sm font-medium transition-colors border border-amber-300"
                        >
                          üëÅÔ∏è Manual Review Queue
                        </button>
                        <button
                          onClick={() => {
                            // Clear all filters first
                            setSearchTerm('');
                            setFilterDetailedStatus('all');
                            setFilterPriority('all');
                            setFilterChannel('all');
                            // Then set this specific filter
                            setFilterHighLevelStatus('Closed - Dismissed');
                          }}
                          className="px-3 py-1.5 bg-red-100 hover:bg-red-200 text-red-800 rounded-md text-sm font-medium transition-colors border border-red-300"
                        >
                          ‚ùå Dismissed Today
                        </button>
                        <button
                          onClick={() => {
                            // Clear all filters first
                            setSearchTerm('');
                            setFilterHighLevelStatus('all');
                            setFilterChannel('all');
                            // Then set these specific filters
                            setFilterDetailedStatus('MD Review');
                            setFilterPriority('High');
                          }}
                          className="px-3 py-1.5 bg-purple-100 hover:bg-purple-200 text-purple-800 rounded-md text-sm font-medium transition-colors border border-purple-300"
                        >
                          üî¥ High Priority MD Review
                        </button>
                      </div>
                      <button
                        onClick={() => {
                          setSearchTerm('');
                          setFilterHighLevelStatus('all');
                          setFilterDetailedStatus('all');
                          setFilterPriority('all');
                          setFilterChannel('all');
                        }}
                        className="px-3 py-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-md text-sm font-medium transition-colors"
                      >
                        Clear All Filters
                      </button>
                    </div>

                    {/* Advanced Filter Options Row */}
                    <div className="grid grid-cols-4 gap-4 pt-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Search</label>
                        <input
                          id="search-input"
                          type="text"
                          placeholder="Packet ID, MBI, NPI, Patient..."
                          aria-label="Search field: Packet ID, MBI, NPI, Patient..."
                          value={searchTerm}
                          onChange={(e) => setSearchTerm(e.target.value)}
                          className="w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Status
                        </label>
                        <div className="flex gap-1 mb-2">
                          <button
                            onClick={() => {
                              setFilterHighLevelStatus('Intake Processing');
                              setFilterDetailedStatus('all');
                            }}
                            className={`px-2 py-0.5 rounded text-xs font-medium transition-colors ${
                              filterHighLevelStatus === 'Intake Processing' 
                                ? 'bg-amber-500 text-white' 
                                : 'bg-amber-100 text-amber-700 hover:bg-amber-200'
                            }`}
                            title="Filter all Intake statuses"
                          >
                            Intake
                          </button>
                          <button
                            onClick={() => {
                              setFilterHighLevelStatus('Clinical Review');
                              setFilterDetailedStatus('all');
                            }}
                            className={`px-2 py-0.5 rounded text-xs font-medium transition-colors ${
                              filterHighLevelStatus === 'Clinical Review' 
                                ? 'bg-purple-500 text-white' 
                                : 'bg-purple-100 text-purple-700 hover:bg-purple-200'
                            }`}
                            title="Filter all Clinical statuses"
                          >
                            Clinical
                          </button>
                          <button
                            onClick={() => {
                              setFilterHighLevelStatus('Delivery In Progress');
                              setFilterDetailedStatus('all');
                            }}
                            className={`px-2 py-0.5 rounded text-xs font-medium transition-colors ${
                              filterHighLevelStatus === 'Delivery In Progress' 
                                ? 'bg-orange-500 text-white' 
                                : 'bg-orange-100 text-orange-700 hover:bg-orange-200'
                            }`}
                            title="Filter all Delivery statuses"
                          >
                            Delivery
                          </button>
                          <button
                            onClick={() => {
                              setFilterHighLevelStatus('Closed - Delivered');
                              setFilterDetailedStatus('all');
                            }}
                            className={`px-2 py-0.5 rounded text-xs font-medium transition-colors ${
                              filterHighLevelStatus === 'Closed - Delivered' 
                                ? 'bg-green-500 text-white' 
                                : 'bg-green-100 text-green-700 hover:bg-green-200'
                            }`}
                            title="Filter Delivered packets"
                          >
                            Delivered
                          </button>
                          <button
                            onClick={() => {
                              setFilterHighLevelStatus('Closed - Dismissed');
                              setFilterDetailedStatus('all');
                            }}
                            className={`px-2 py-0.5 rounded text-xs font-medium transition-colors ${
                              filterHighLevelStatus === 'Closed - Dismissed' 
                                ? 'bg-red-500 text-white' 
                                : 'bg-red-100 text-red-700 hover:bg-red-200'
                            }`}
                            title="Filter Dismissed packets"
                          >
                            Dismissed
                          </button>
                        </div>
                        <select
                          value={filterDetailedStatus}
                          onChange={(e) => {
                            const value = e.target.value;
                            setFilterDetailedStatus(value);
                            // Auto-set high-level status based on detailed status
                            if (['Received', 'OCR Extraction', 'Manual Review', 'Validating', 'Case Created'].includes(value)) {
                              setFilterHighLevelStatus('Intake Processing');
                            } else if (['Pending Review', 'In Progress', 'MD Review', 'Need More Info'].includes(value)) {
                              setFilterHighLevelStatus('Clinical Review');
                            } else if (['Queued', 'Delivery In Progress'].includes(value)) {
                              setFilterHighLevelStatus('Delivery In Progress');
                            } else if (value === 'Delivered') {
                              setFilterHighLevelStatus('Closed - Delivered');
                            } else if (value === 'Dismissed') {
                              setFilterHighLevelStatus('Closed - Dismissed');
                            } else {
                              setFilterHighLevelStatus('all');
                            }
                          }}
                          className="w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        >
                          <option value="all">All Statuses</option>
                          <optgroup label="üìÇ Intake" style={{fontWeight: 'bold', backgroundColor: '#FEF3C7'}}>
                            <option value="Received">Received</option>
                            <option value="OCR Extraction">OCR Extraction</option>
                            <option value="Manual Review">Manual Review</option>
                            <option value="Validating">Eligibility/Provider Check</option>
                            <option value="Case Created">Case Created</option>
                          </optgroup>
                          <optgroup label="üìÇ Clinical" style={{fontWeight: 'bold', backgroundColor: '#E9D5FF'}}>
                            <option value="Pending Review">Pending Review</option>
                            <option value="In Progress">In Progress</option>
                            <option value="MD Review">MD Review</option>
                            <option value="Need More Info">Need More Info</option>
                          </optgroup>
                          <optgroup label="üìÇ Delivery" style={{fontWeight: 'bold', backgroundColor: '#FED7AA'}}>
                            <option value="Queued">Queued</option>
                            <option value="Delivery In Progress">Delivery In Progress</option>
                          </optgroup>
                          <optgroup label="üìÇ Closed" style={{fontWeight: 'bold', backgroundColor: '#D1FAE5'}}>
                            <option value="Delivered">Delivered</option>
                            <option value="Dismissed">Dismissed</option>
                          </optgroup>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                        <select
                          value={filterPriority}
                          onChange={(e) => setFilterPriority(e.target.value)}
                          className="w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        >
                          <option value="all">All Priorities</option>
                          <option value="Standard">Standard</option>
                          <option value="Expedited">‚ö° Expedited</option>
                          <option value="High">üî¥ High</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Channel</label>
                        <select
                          value={filterChannel}
                          onChange={(e) => setFilterChannel(e.target.value)}
                          className="w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        >
                          <option value="all">All Channels</option>
                          <option value="esMD">esMD</option>
                          <option value="Fax">Fax</option>
                          <option value="Portal">Portal</option>
                          <option value="Mailroom">Mailroom</option>
                        </select>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              {/* Packets Table */}
              <div className="bg-white rounded-lg shadow overflow-hidden">
                <div className="overflow-x-auto">
                  <table className="min-w-full divide-y divide-gray-200">
                    <thead className="bg-gray-50">
                      <tr>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Packet ID
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Received
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Channel
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Patient
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Provider
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Service
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          High-Level Status
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Detailed Status
                        </th>
                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                          Actions
                        </th>
                      </tr>
                    </thead>
                    <tbody className="bg-white divide-y divide-gray-200">
                      {filteredPackets.map((packet) => (
                        <tr key={packet.id} className="hover:bg-gray-50">
                          <td className="px-4 py-4 whitespace-nowrap">
                            <div className="text-sm font-medium text-blue-600 cursor-pointer hover:text-blue-800">
                              {packet.id}
                            </div>
                            {packet.priority === 'Expedited' && (
                              <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 border border-orange-300">
                                ‚ö° Expedited
                              </span>
                            )}
                            {packet.priority === 'High' && (
                              <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 border border-red-300">
                                üî¥ High
                              </span>
                            )}
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap text-sm text-gray-600">
                            {packet.receivedDate}
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap">
                            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                              packet.channel === 'esMD' ? 'bg-blue-100 text-blue-800' :
                              packet.channel === 'Fax' ? 'bg-green-100 text-green-800' :
                              packet.channel === 'Portal' ? 'bg-purple-100 text-purple-800' :
                              'bg-gray-100 text-gray-800'
                            }`}>
                              {packet.channel}
                            </span>
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap">
                            <div className="text-sm font-medium text-gray-900">{packet.patient}</div>
                            <div className="text-sm text-gray-500">{packet.mbi}</div>
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap">
                            <div className="text-sm text-gray-900">{packet.provider}</div>
                            <div className="text-sm text-gray-500">NPI: {packet.npi}</div>
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap text-sm text-gray-600">
                            {packet.service}
                          </td>
                          <td className="px-4 py-4">
                            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold border ${
                              packet.highLevelStatus === 'Intake Processing' ? 'bg-amber-100 text-amber-800 border-amber-300' :
                              packet.highLevelStatus === 'Clinical Review' ? 'bg-purple-100 text-purple-800 border-purple-300' :
                              packet.highLevelStatus === 'Delivery In Progress' ? 'bg-orange-100 text-orange-800 border-orange-300' :
                              packet.highLevelStatus === 'Closed - Delivered' ? 'bg-green-100 text-green-800 border-green-300' :
                              packet.highLevelStatus === 'Closed - Dismissed' ? 'bg-red-100 text-red-800 border-red-300' :
                              'bg-gray-100 text-gray-800 border-gray-300'
                            }`}>
                              {packet.highLevelStatus}
                            </span>
                          </td>
                          <td className="px-4 py-4">
                            <div className="space-y-1">
                              <div className="text-sm font-medium text-gray-900">
                                Intake: <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs border ${getStatusBadge(packet.status, packet.statusColor)}`}>
                                  {packet.status}
                                </span>
                              </div>
                              {packet.clinicalStatus && (
                                <div className="text-sm text-gray-700">
                                  Clinical: <span className="px-2 py-0.5 rounded text-xs bg-purple-50 text-purple-700 border border-purple-200">
                                    {packet.clinicalStatus}
                                  </span>
                                </div>
                              )}
                              {packet.deliveryStatus && (
                                <div className="text-sm text-gray-700">
                                  Delivery: <span className="px-2 py-0.5 rounded text-xs bg-orange-50 text-orange-700 border border-orange-200">
                                    {packet.deliveryStatus}
                                  </span>
                                </div>
                              )}
                              {packet.dismissalReason && (
                                <div className="text-xs text-red-600 mt-1">{packet.dismissalReason}</div>
                              )}
                              {packet.archiveReason && (
                                <div className="text-xs text-gray-600 mt-1">{packet.archiveReason}</div>
                              )}
                            </div>
                          </td>
                          <td className="px-4 py-4 whitespace-nowrap text-sm">
                            <div className="flex gap-2">
                              <a 
                                href={`FINAL_packet_detail_view.html?id=${packet.id}&status=${getDetailViewStatus(packet)}`}
                                className="text-blue-600 hover:text-blue-900 font-medium"
                                aria-label={`View details for packet ${packet.id}`}
                              >
                                View
                              </a>
                              {packet.status === 'Manual Review' && (
                                <a 
                                  href={`FINAL_manual_review.html?id=${packet.id}&type=${packet.reviewType || 'fields'}`}
                                  className="text-amber-600 hover:text-amber-900 font-semibold"
                                >
                                  Review
                                </a>
                              )}
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                {filteredPackets.length === 0 && (
                  <div className="text-center py-12 text-gray-500">
                    No packets found matching your filters
                  </div>
                )}
              </div>

              {/* Pagination */}
              <div className="bg-white rounded-lg shadow p-4 mt-6 flex items-center justify-between">
                <div className="text-sm text-gray-600">
                  Showing <span className="font-semibold">{filteredPackets.length}</span> of <span className="font-semibold">{packets.length}</span> packets
                </div>
                <div className="flex gap-2">
                  <button className="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50" disabled>
                    Previous
                  </button>
                  <button className="px-3 py-1 bg-blue-600 text-white rounded">1</button>
                  <button className="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50">2</button>
                  <button className="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50">3</button>
                  <button className="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50">
                    Next
                  </button>
                </div>
              </div>
              </main>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PacketsDashboard />);
    </script>
</body>
</html>
